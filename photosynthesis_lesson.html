<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Photosynthesis Lesson - Undergraduate Introduction</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2ecc71;
            --secondary-color: #27ae60;
            --accent-color: #f39c12;
            --light-bg: #ecf0f1;
            --dark-text: #2c3e50;
            --light-text: #7f8c8d;
            --success: #27ae60;
            --error: #e74c3c;
            --warning: #f39c12;
            --info: #3498db;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            min-height: 100vh;
        }

        body.text-small {
            font-size: 14px;
        }

        body.text-large {
            font-size: 20px;
        }

        body.high-contrast {
            --primary-color: #000000;
            --secondary-color: #000000;
            --light-bg: #ffffff;
            --dark-text: #000000;
            --light-text: #000000;
            background: #ffffff;
        }

        body.high-contrast .container {
            background: #ffffff;
            border: 3px solid #000000;
        }

        body.high-contrast .section {
            border: 2px solid #000000;
        }

        .accessibility-toolbar {
            background: var(--dark-text);
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .toolbar-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .toolbar-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .toolbar-btn:focus {
            outline: 3px solid var(--accent-color);
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .progress-container {
            background: var(--light-bg);
            padding: 20px;
            border-bottom: 2px solid var(--primary-color);
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: var(--light-text);
        }

        .content {
            padding: 30px;
        }

        .section {
            background: var(--light-bg);
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 10px;
            border-left: 5px solid var(--primary-color);
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes highlightPulse {
            0% {
                background: #e3f2fd;
                transform: scale(1);
            }
            50% {
                background: #bbdefb;
                transform: scale(1.02);
            }
            100% {
                background: #e3f2fd;
                transform: scale(1);
            }
        }

        .section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 {
            color: var(--secondary-color);
            margin: 20px 0 10px 0;
            font-size: 1.5em;
        }

        .key-concept {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .equation-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.3em;
            margin: 20px 0;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .diagram-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .chloroplast-diagram {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            aspect-ratio: 4/3;
        }

        .chloroplast-svg {
            width: 100%;
            height: 100%;
        }

        .label-point {
            cursor: pointer;
            transition: all 0.3s;
        }

        .label-point:hover circle:first-child {
            r: 10;
            fill: var(--accent-color);
        }

        .label-point:hover circle:nth-child(2) {
            r: 16;
            stroke: var(--accent-color);
            opacity: 1;
        }

        .label-point:active circle:first-child {
            fill: var(--success);
        }

        .label-point circle:nth-child(2) {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { 
                r: 12;
                opacity: 0.5;
            }
            50% { 
                r: 16;
                opacity: 0.8;
            }
        }

        .label-text {
            font-size: 14px;
            font-weight: bold;
            fill: var(--dark-text);
            pointer-events: none;
        }

        .interactive-area {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed var(--primary-color);
        }

        .drag-item {
            background: white;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            cursor: move;
            display: inline-block;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border: 2px solid var(--primary-color);
        }

        .drag-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .drag-item.dragging {
            opacity: 0.5;
        }

        .drop-zone {
            background: white;
            border: 3px dashed var(--light-text);
            padding: 20px;
            margin: 10px;
            border-radius: 8px;
            min-height: 60px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light-text);
        }

        .drop-zone.drag-over {
            background: #e8f5e9;
            border-color: var(--primary-color);
        }

        .drop-zone.correct {
            background: #d4edda;
            border-color: var(--success);
            color: var(--success);
        }

        .drop-zone.incorrect {
            background: #f8d7da;
            border-color: var(--error);
            color: var(--error);
        }

        .quiz-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .quiz-question {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--dark-text);
        }

        .quiz-option {
            background: var(--light-bg);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .quiz-option:hover {
            background: #dfe6e9;
            transform: translateX(5px);
        }

        .quiz-option.selected {
            border-color: var(--primary-color);
            background: #e8f5e9;
        }

        .quiz-option.correct {
            background: #d4edda;
            border-color: var(--success);
        }

        .quiz-option.incorrect {
            background: #f8d7da;
            border-color: var(--error);
        }

        .feedback {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: bold;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .feedback.success {
            background: #d4edda;
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .feedback.error {
            background: #f8d7da;
            color: var(--error);
            border-left: 4px solid var(--error);
        }

        .animation-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            color: white;
        }

        .animation-stage {
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 10px;
            position: relative;
            min-height: 300px;
            backdrop-filter: blur(10px);
        }

        .particle {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            transition: all 1s ease-in-out;
        }

        .photon {
            background: #f1c40f;
            box-shadow: 0 0 20px #f1c40f;
        }

        .electron {
            background: #3498db;
            box-shadow: 0 0 15px #3498db;
        }

        .molecule {
            background: #e74c3c;
            box-shadow: 0 0 15px #e74c3c;
            width: 30px;
            height: 30px;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn:focus {
            outline: 3px solid var(--accent-color);
        }

        .btn:disabled {
            background: var(--light-text);
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--light-text);
        }

        .btn-secondary:hover {
            background: #95a5a6;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid var(--info);
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid var(--warning);
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid var(--success);
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .instructor-notes {
            background: #fff9e6;
            border: 2px solid var(--accent-color);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .instructor-notes h4 {
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .timer-display {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--primary-color);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .hotspot {
            cursor: pointer;
            transition: all 0.3s;
        }

        .hotspot:hover {
            opacity: 0.7;
            filter: brightness(1.2);
        }

        .tooltip {
            position: absolute;
            background: var(--dark-text);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 0.9em;
            z-index: 1000;
            max-width: 300px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            display: none;
        }

        .tooltip.show {
            display: block;
        }

        .score-display {
            text-align: center;
            font-size: 2em;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            margin: 20px 0;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border-width: 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 15px;
            }

            .navigation-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        @media print {
            .accessibility-toolbar,
            .navigation-buttons,
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="accessibility-toolbar" role="toolbar" aria-label="Accessibility Controls">
        <div class="toolbar-group">
            <button class="toolbar-btn" onclick="adjustTextSize('small')" aria-label="Small text size">
                A-
            </button>
            <button class="toolbar-btn" onclick="adjustTextSize('medium')" aria-label="Medium text size">
                A
            </button>
            <button class="toolbar-btn" onclick="adjustTextSize('large')" aria-label="Large text size">
                A+
            </button>
            <button class="toolbar-btn" onclick="toggleHighContrast()" aria-label="Toggle high contrast mode">
                High Contrast
            </button>
            <button class="toolbar-btn" id="ttsToggle" onclick="toggleTTS()" aria-label="Toggle text to speech">
                üîä Text-to-Speech: OFF
            </button>
        </div>
        <div class="toolbar-group">
            <span class="timer-display" id="timer" aria-live="polite">Time: 00:00</span>
            <button class="toolbar-btn" onclick="toggleTimer()" id="timerToggle" aria-label="Toggle timer">
                Start Timer
            </button>
        </div>
    </div>

    <div class="container">
        <header class="header" role="banner">
            <h1>Photosynthesis: The Foundation of Life</h1>
            <p>An Interactive Introduction for Undergraduate Students</p>
        </header>

        <div class="progress-container" role="region" aria-label="Lesson Progress">
            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            <div class="progress-info">
                <span id="sectionCounter">Section 1 of 9</span>
                <span id="completionStatus">Just getting started!</span>
            </div>
        </div>

        <main class="content" role="main">
            <!-- Section 1: Introduction -->
            <section class="section active" id="section1" aria-labelledby="section1-title">
                <h2 id="section1-title">
                    <span aria-hidden="true">üå±</span>
                    Introduction: Why Photosynthesis Matters
                </h2>

                <div class="key-concept">
                    <h3>What You'll Learn</h3>
                    <p>Welcome to this interactive lesson on photosynthesis! By the end of this one-hour session, you will understand:</p>
                    <ul style="margin: 15px 0 15px 30px; line-height: 2;">
                        <li>The fundamental process of photosynthesis and why it's essential for life on Earth</li>
                        <li>The structure of chloroplasts and their role in photosynthesis</li>
                        <li>Light-dependent reactions and how plants capture solar energy</li>
                        <li>Light-independent reactions (Calvin Cycle) and how glucose is produced</li>
                        <li>The relationship between photosynthesis and cellular respiration</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h3>Did You Know?</h3>
                    <p><strong>Photosynthesis is responsible for producing approximately 170 billion tons of carbohydrates annually.</strong> Without this process, life as we know it would not exist. Every breath of oxygen you take, every bite of food you eat, and the fossil fuels that power our world all trace back to photosynthesis.</p>
                </div>

                <h3>The Big Picture</h3>
                <p>Photosynthesis is the process by which plants, algae, and some bacteria convert light energy (usually from the sun) into chemical energy stored in glucose molecules. This process not only provides food for the organisms that perform it but also produces oxygen as a byproduct‚Äîthe very oxygen that most life on Earth depends on for survival.</p>

                <div class="equation-box" role="img" aria-label="Photosynthesis equation: 6 carbon dioxide plus 6 water plus light energy yields glucose plus 6 oxygen">
                    6CO‚ÇÇ + 6H‚ÇÇO + Light Energy ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ
                    <div style="font-size: 0.7em; margin-top: 10px; opacity: 0.9;">
                        Carbon Dioxide + Water + Light ‚Üí Glucose + Oxygen
                    </div>
                </div>

                <h3>Historical Context</h3>
                <p>The understanding of photosynthesis developed over centuries. In the 1770s, Joseph Priestley discovered that plants could "restore" air that had been "injured" by burning candles. Later, Jan Ingenhousz showed that light was necessary for this process. In the 1940s, Melvin Calvin traced the path of carbon through the photosynthetic process, work for which he won the Nobel Prize.</p>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Teaching Tip:</strong> Before moving forward, ask students to reflect on where they see evidence of photosynthesis in their daily lives. This helps connect abstract concepts to concrete observations.</p>
                    <p><strong>Common Misconception:</strong> Students often think plants "breathe in" CO‚ÇÇ and "breathe out" O‚ÇÇ like humans reverse. Clarify that this is a metabolic process, not respiration.</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" disabled>Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Chloroplast Structure ‚Üí</button>
                </div>
            </section>

            <!-- Section 2: Chloroplast Structure -->
            <section class="section" id="section2" aria-labelledby="section2-title">
                <h2 id="section2-title">
                    <span aria-hidden="true">üî¨</span>
                    Chloroplast Structure: The Photosynthesis Factory
                </h2>

                <p>Before we dive into the reactions themselves, we need to understand where photosynthesis occurs. Chloroplasts are the specialized organelles in plant cells where photosynthesis takes place. Think of them as solar-powered factories that convert sunlight into chemical energy.</p>

                <div class="diagram-container">
                    <h3>Interactive Chloroplast Diagram</h3>
                    <p style="color: var(--info); font-weight: bold; margin-bottom: 15px;">Click on the numbered points to learn about each structure:</p>
                    
                    <svg class="chloroplast-svg" viewBox="0 0 600 450" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Interactive chloroplast structure diagram">
                        <!-- Outer membrane -->
                        <ellipse cx="300" cy="225" rx="250" ry="180" fill="#90EE90" stroke="#2ecc71" stroke-width="3" />
                        
                        <!-- Inner membrane -->
                        <ellipse cx="300" cy="225" rx="230" ry="160" fill="#98FB98" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,5" />
                        
                        <!-- Stroma -->
                        <text x="300" y="370" text-anchor="middle" fill="#2ecc71" font-size="16" font-weight="bold">Stroma</text>
                        
                        <!-- Thylakoids -->
                        <g id="thylakoid1">
                            <ellipse cx="200" cy="180" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                            <ellipse cx="200" cy="200" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                            <ellipse cx="200" cy="220" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                        </g>
                        
                        <g id="thylakoid2">
                            <ellipse cx="400" cy="180" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                            <ellipse cx="400" cy="200" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                            <ellipse cx="400" cy="220" rx="60" ry="15" fill="#228B22" opacity="0.8" />
                        </g>
                        
                        <!-- Granum label -->
                        <text x="200" y="250" text-anchor="middle" fill="#1a5f1a" font-size="14" font-weight="bold">Granum</text>
                        <text x="400" y="250" text-anchor="middle" fill="#1a5f1a" font-size="14" font-weight="bold">Granum</text>
                        
                        <!-- Interactive points -->
                        <g class="label-point hotspot" onclick="showChloroplastInfo('outer')" style="cursor: pointer;" tabindex="0" role="button" aria-label="Learn about outer membrane">
                            <circle cx="520" cy="225" r="8" fill="#e74c3c" />
                            <circle cx="520" cy="225" r="12" fill="none" stroke="#e74c3c" stroke-width="2" opacity="0.5" />
                            <text x="530" y="230" class="label-text" fill="#2c3e50" font-size="14" font-weight="bold">1</text>
                        </g>
                        
                        <g class="label-point hotspot" onclick="showChloroplastInfo('inner')" style="cursor: pointer;" tabindex="0" role="button" aria-label="Learn about inner membrane">
                            <circle cx="500" cy="190" r="8" fill="#e74c3c" />
                            <circle cx="500" cy="190" r="12" fill="none" stroke="#e74c3c" stroke-width="2" opacity="0.5" />
                            <text x="510" y="195" class="label-text" fill="#2c3e50" font-size="14" font-weight="bold">2</text>
                        </g>
                        
                        <g class="label-point hotspot" onclick="showChloroplastInfo('stroma')" style="cursor: pointer;" tabindex="0" role="button" aria-label="Learn about stroma">
                            <circle cx="300" cy="330" r="8" fill="#e74c3c" />
                            <circle cx="300" cy="330" r="12" fill="none" stroke="#e74c3c" stroke-width="2" opacity="0.5" />
                            <text x="310" y="335" class="label-text" fill="#2c3e50" font-size="14" font-weight="bold">3</text>
                        </g>
                        
                        <g class="label-point hotspot" onclick="showChloroplastInfo('thylakoid')" style="cursor: pointer;" tabindex="0" role="button" aria-label="Learn about thylakoid">
                            <circle cx="200" cy="240" r="8" fill="#e74c3c" />
                            <circle cx="200" cy="240" r="12" fill="none" stroke="#e74c3c" stroke-width="2" opacity="0.5" />
                            <text x="210" y="245" class="label-text" fill="#2c3e50" font-size="14" font-weight="bold">4</text>
                        </g>
                        
                        <g class="label-point hotspot" onclick="showChloroplastInfo('granum')" style="cursor: pointer;" tabindex="0" role="button" aria-label="Learn about granum">
                            <circle cx="150" cy="180" r="8" fill="#e74c3c" />
                            <circle cx="150" cy="180" r="12" fill="none" stroke="#e74c3c" stroke-width="2" opacity="0.5" />
                            <text x="160" y="185" class="label-text" fill="#2c3e50" font-size="14" font-weight="bold">5</text>
                        </g>
                    </svg>
                </div>

                <div class="info-box" id="chloroplastInfo">
                    <h3 id="chloroplastInfoTitle">Click a numbered point to learn more</h3>
                    <p id="chloroplastInfoText">The chloroplast diagram above shows the key structures involved in photosynthesis. Click on any of the five numbered red points to discover what each part does!</p>
                </div>

                <div class="key-concept">
                    <h3>Key Structures Summary</h3>
                    <div class="grid-2">
                        <div class="card">
                            <h4>Outer & Inner Membranes</h4>
                            <p>Control what enters and exits the chloroplast, creating a separate compartment for photosynthesis.</p>
                        </div>
                        <div class="card">
                            <h4>Stroma</h4>
                            <p>The fluid-filled space where the Calvin Cycle (light-independent reactions) occurs.</p>
                        </div>
                        <div class="card">
                            <h4>Thylakoids</h4>
                            <p>Flattened sac-like membranes where the light-dependent reactions take place.</p>
                        </div>
                        <div class="card">
                            <h4>Grana (plural of Granum)</h4>
                            <p>Stacks of thylakoids that maximize surface area for light absorption.</p>
                        </div>
                    </div>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Analogy:</strong> Compare the chloroplast to a factory with two production lines‚Äîone in the thylakoids (assembly line using sunlight) and one in the stroma (assembly line using the products from the first line).</p>
                    <p><strong>Activity Extension:</strong> Have students create their own analogies for chloroplast structure using familiar buildings or systems.</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Light-Dependent Reactions ‚Üí</button>
                </div>
            </section>

            <!-- Section 3: Light-Dependent Reactions -->
            <section class="section" id="section3" aria-labelledby="section3-title">
                <h2 id="section3-title">
                    <span aria-hidden="true">‚òÄÔ∏è</span>
                    Light-Dependent Reactions: Capturing Solar Energy
                </h2>

                <p>The light-dependent reactions are the first stage of photosynthesis. They occur in the thylakoid membranes and convert light energy into chemical energy in the form of ATP and NADPH. These energy carriers will be used in the next stage to produce glucose.</p>

                <div class="key-concept">
                    <h3>Location: Thylakoid Membranes</h3>
                    <p><strong>Main Purpose:</strong> Convert light energy into chemical energy (ATP and NADPH) and split water molecules to release oxygen.</p>
                </div>

                <div class="animation-container">
                    <h3>Animated Process Walkthrough</h3>
                    <p style="margin-bottom: 15px;">Watch how light energy is captured and converted:</p>
                    <div class="animation-stage" id="lightReactionStage" role="region" aria-live="polite" aria-atomic="true">
                        <div style="text-align: center; color: white; font-size: 1.2em; padding: 20px;" id="animationText">
                            Click "Start Animation" to begin
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn" onclick="startLightReactionAnimation()" id="animationBtn">Start Animation</button>
                    </div>
                </div>

                <h3>The Key Steps</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>1. Light Absorption</h4>
                        <p><strong>Photosystem II (PSII)</strong> absorbs light energy through chlorophyll pigments. This energizes electrons, which are then passed to an electron transport chain.</p>
                    </div>
                    <div class="card">
                        <h4>2. Water Splitting</h4>
                        <p><strong>Photolysis</strong> occurs: H‚ÇÇO ‚Üí 2H‚Å∫ + ¬ΩO‚ÇÇ + 2e‚Åª. This replaces the electrons lost from PSII and releases oxygen as a byproduct!</p>
                    </div>
                    <div class="card">
                        <h4>3. Electron Transport Chain</h4>
                        <p>Electrons move through proteins in the membrane, pumping H‚Å∫ ions into the thylakoid space, creating a concentration gradient.</p>
                    </div>
                    <div class="card">
                        <h4>4. Photosystem I (PSI)</h4>
                        <p>More light energy is absorbed, further energizing electrons, which are ultimately used to reduce NADP‚Å∫ to NADPH.</p>
                    </div>
                    <div class="card">
                        <h4>5. ATP Synthesis</h4>
                        <p><strong>Chemiosmosis:</strong> H‚Å∫ ions flow through ATP synthase, driving the production of ATP from ADP + Pi.</p>
                    </div>
                    <div class="card">
                        <h4>6. Products</h4>
                        <p><strong>Result:</strong> ATP (energy), NADPH (reducing power), and O‚ÇÇ (byproduct) are produced for use in the next stage.</p>
                    </div>
                </div>

                <div class="warning-box">
                    <h3>Common Misconception</h3>
                    <p><strong>Myth:</strong> "Plants produce oxygen for us to breathe."</p>
                    <p><strong>Reality:</strong> The oxygen is actually a waste product of splitting water molecules! Plants evolved this mechanism to obtain electrons, not specifically to produce oxygen. The oxygen release is a fortunate consequence for aerobic life.</p>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Emphasis Point:</strong> The light-dependent reactions are called "photo" (light) "phosphorylation" because they use light energy to add phosphate to ADP, creating ATP.</p>
                    <p><strong>Connection:</strong> Students who've studied cellular respiration will recognize ATP synthase‚Äîit works similarly but in reverse!</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Quiz Time! ‚Üí</button>
                </div>
            </section>

            <!-- Section 4: Quiz 1 -->
            <section class="section" id="section4" aria-labelledby="section4-title">
                <h2 id="section4-title">
                    <span aria-hidden="true">‚úÖ</span>
                    Knowledge Check: Light-Dependent Reactions
                </h2>

                <p>Let's test your understanding of what we've covered so far!</p>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 1: Where do the light-dependent reactions occur?
                    </div>
                    <div class="quiz-option" data-question="1" data-correct="false" onclick="checkQuiz(this)">
                        A) Stroma of the chloroplast
                    </div>
                    <div class="quiz-option" data-question="1" data-correct="true" onclick="checkQuiz(this)">
                        B) Thylakoid membranes of the chloroplast
                    </div>
                    <div class="quiz-option" data-question="1" data-correct="false" onclick="checkQuiz(this)">
                        C) Cytoplasm of the cell
                    </div>
                    <div class="quiz-option" data-question="1" data-correct="false" onclick="checkQuiz(this)">
                        D) Mitochondria
                    </div>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 2: What are the main products of the light-dependent reactions?
                    </div>
                    <div class="quiz-option" data-question="2" data-correct="false" onclick="checkQuiz(this)">
                        A) Glucose and oxygen
                    </div>
                    <div class="quiz-option" data-question="2" data-correct="true" onclick="checkQuiz(this)">
                        B) ATP, NADPH, and oxygen
                    </div>
                    <div class="quiz-option" data-question="2" data-correct="false" onclick="checkQuiz(this)">
                        C) Carbon dioxide and water
                    </div>
                    <div class="quiz-option" data-question="2" data-correct="false" onclick="checkQuiz(this)">
                        D) ADP and NADP+
                    </div>
                    <div class="feedback" id="feedback2"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 3: Why is oxygen released during photosynthesis?
                    </div>
                    <div class="quiz-option" data-question="3" data-correct="false" onclick="checkQuiz(this)">
                        A) Because plants don't need oxygen
                    </div>
                    <div class="quiz-option" data-question="3" data-correct="false" onclick="checkQuiz(this)">
                        B) Because it's produced from carbon dioxide
                    </div>
                    <div class="quiz-option" data-question="3" data-correct="true" onclick="checkQuiz(this)">
                        C) As a byproduct of splitting water molecules to obtain electrons
                    </div>
                    <div class="quiz-option" data-question="3" data-correct="false" onclick="checkQuiz(this)">
                        D) To provide oxygen for animals
                    </div>
                    <div class="feedback" id="feedback3"></div>
                </div>

                <div class="success-box" id="quiz1Complete" style="display: none;">
                    <h3>‚úì Great Job!</h3>
                    <p>You've completed the first knowledge check. Let's continue to the Calvin Cycle!</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" id="quiz1Next" onclick="nextSection()" disabled>Next: Calvin Cycle ‚Üí</button>
                </div>
            </section>

            <!-- Section 5: Calvin Cycle -->
            <section class="section" id="section5" aria-labelledby="section5-title">
                <h2 id="section5-title">
                    <span aria-hidden="true">üîÑ</span>
                    Light-Independent Reactions: The Calvin Cycle
                </h2>

                <p>The Calvin Cycle, also known as the light-independent reactions or "dark reactions," uses the ATP and NADPH produced in the light-dependent reactions to convert carbon dioxide into glucose. While these reactions don't directly require light, they typically occur during the day when ATP and NADPH are being produced.</p>

                <div class="key-concept">
                    <h3>Location: Stroma</h3>
                    <p><strong>Main Purpose:</strong> Fix carbon dioxide from the atmosphere and use ATP and NADPH to build glucose molecules.</p>
                </div>

                <h3>The Three Phases of the Calvin Cycle</h3>

                <div class="interactive-area">
                    <h4 style="text-align: center; margin-bottom: 20px;">Interactive: Order the Phases</h4>
                    <p style="text-align: center; color: var(--light-text); margin-bottom: 15px;">
                        Drag the phases into the correct order (1 ‚Üí 2 ‚Üí 3)
                    </p>
                    <div style="display: flex; flex-wrap: wrap; justify-content: center; margin-bottom: 20px;" id="dragItems">
                        <div class="drag-item" draggable="true" data-phase="3">
                            <strong>Regeneration of RuBP</strong><br>
                            Using ATP to regenerate the CO‚ÇÇ acceptor
                        </div>
                        <div class="drag-item" draggable="true" data-phase="1">
                            <strong>Carbon Fixation</strong><br>
                            CO‚ÇÇ combines with RuBP via rubisco enzyme
                        </div>
                        <div class="drag-item" draggable="true" data-phase="2">
                            <strong>Reduction</strong><br>
                            Using ATP and NADPH to produce G3P
                        </div>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; justify-content: space-around; gap: 10px;">
                        <div class="drop-zone" data-position="1">Phase 1</div>
                        <div class="drop-zone" data-position="2">Phase 2</div>
                        <div class="drop-zone" data-position="3">Phase 3</div>
                    </div>
                    <div class="feedback" id="calvinFeedback"></div>
                </div>

                <div class="grid-2">
                    <div class="card">
                        <h4>Phase 1: Carbon Fixation</h4>
                        <p><strong>What happens:</strong> CO‚ÇÇ from the atmosphere enters the stroma and is attached to a 5-carbon molecule called ribulose bisphosphate (RuBP) by the enzyme rubisco.</p>
                        <p><strong>Result:</strong> A 6-carbon molecule that immediately splits into two 3-carbon molecules (3-phosphoglycerate or 3-PGA).</p>
                        <p style="margin-top: 10px; padding: 10px; background: #e3f2fd; border-radius: 5px;">
                            <strong>Did you know?</strong> Rubisco is the most abundant enzyme on Earth!
                        </p>
                    </div>
                    <div class="card">
                        <h4>Phase 2: Reduction</h4>
                        <p><strong>What happens:</strong> ATP and NADPH from the light reactions are used to convert 3-PGA into glyceraldehyde-3-phosphate (G3P), a 3-carbon sugar.</p>
                        <p><strong>Result:</strong> For every 3 CO‚ÇÇ fixed, six G3P molecules are produced. Five are recycled, and one exits the cycle.</p>
                    </div>
                    <div class="card">
                        <h4>Phase 3: Regeneration</h4>
                        <p><strong>What happens:</strong> Five G3P molecules (15 carbons total) are rearranged using ATP to regenerate three RuBP molecules (also 15 carbons).</p>
                        <p><strong>Result:</strong> The cycle can continue accepting more CO‚ÇÇ.</p>
                    </div>
                    <div class="card">
                        <h4>Net Output</h4>
                        <p><strong>One "turn" of Calvin Cycle:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Input: 3 CO‚ÇÇ, 9 ATP, 6 NADPH</li>
                            <li>Output: 1 G3P molecule</li>
                            <li>Two G3P molecules = one glucose</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Therefore: 6 CO‚ÇÇ molecules are needed to make one glucose molecule!</strong></p>
                    </div>
                </div>

                <div class="equation-box" role="img" aria-label="Calvin Cycle summary equation">
                    3 CO‚ÇÇ + 9 ATP + 6 NADPH + 6 H‚Å∫ ‚Üí G3P + 9 ADP + 8 Pi + 6 NADP‚Å∫ + 3 H‚ÇÇO
                    <div style="font-size: 0.7em; margin-top: 10px; opacity: 0.9;">
                        (This happens twice to produce one glucose molecule)
                    </div>
                </div>

                <div class="info-box">
                    <h3>Why "Dark Reactions" is Misleading</h3>
                    <p>The Calvin Cycle is sometimes called the "dark reactions" because it doesn't directly require light. However, this name is misleading because:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li>It depends on ATP and NADPH from light reactions, which are produced in the light</li>
                        <li>It typically occurs simultaneously with light reactions during the day</li>
                        <li>Some enzymes in the cycle are actually activated by light</li>
                    </ul>
                    <p style="margin-top: 10px;"><strong>Better term:</strong> Light-independent reactions!</p>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Emphasis:</strong> The "3" in "3 CO‚ÇÇ" corresponds to the "3" in the outputs. This is one complete cycle. Stress that 2 cycles are needed for one glucose.</p>
                    <p><strong>Common Mistake:</strong> Students often forget that most G3P is recycled. Only 1 out of 6 G3P molecules exits the cycle.</p>
                    <p><strong>Math Connection:</strong> Have students calculate: If 3 CO‚ÇÇ make 1 G3P, and 2 G3P make 1 glucose, how many CO‚ÇÇ are needed? (Answer: 6)</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Putting It All Together ‚Üí</button>
                </div>
            </section>

            <!-- Section 6: Integration -->
            <section class="section" id="section6" aria-labelledby="section6-title">
                <h2 id="section6-title">
                    <span aria-hidden="true">üîó</span>
                    Putting It All Together: The Complete Process
                </h2>

                <p>Now that we've explored both stages of photosynthesis, let's see how they work together as an integrated system. Understanding these connections is crucial for grasping the elegance of this process.</p>

                <div class="key-concept">
                    <h3>The Two-Stage System</h3>
                    <p>Photosynthesis is a carefully coordinated two-stage process where the products of one stage are the reactants of the next.</p>
                </div>

                <div class="diagram-container" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h3 style="color: white;">Complete Photosynthesis Overview</h3>
                    <div style="padding: 30px;">
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0; backdrop-filter: blur(10px);">
                            <h4 style="color: #f1c40f; margin-bottom: 10px;">STAGE 1: Light-Dependent Reactions (Thylakoids)</h4>
                            <p><strong>Inputs:</strong> H‚ÇÇO + Light Energy + ADP + Pi + NADP‚Å∫</p>
                            <p><strong>Outputs:</strong> O‚ÇÇ + ATP + NADPH</p>
                            <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.9;">üí° Converts light energy into chemical energy</p>
                        </div>
                        <div style="text-align: center; font-size: 2em; margin: 20px 0;">
                            ‚Üì
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0; backdrop-filter: blur(10px);">
                            <h4 style="color: #2ecc71; margin-bottom: 10px;">STAGE 2: Light-Independent Reactions / Calvin Cycle (Stroma)</h4>
                            <p><strong>Inputs:</strong> CO‚ÇÇ + ATP + NADPH</p>
                            <p><strong>Outputs:</strong> Glucose (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ) + ADP + Pi + NADP‚Å∫</p>
                            <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.9;">üå± Uses chemical energy to build glucose</p>
                        </div>
                    </div>
                </div>

                <h3>The Interdependence</h3>
                <div class="grid-2">
                    <div class="card" style="border-left: 4px solid #3498db;">
                        <h4>ATP & NADPH: Energy Carriers</h4>
                        <p>The light reactions produce ATP and NADPH, which are immediately used by the Calvin Cycle. Without a constant supply of these energy carriers, carbon fixation would stop.</p>
                        <p style="margin-top: 10px; padding: 10px; background: #e3f2fd; border-radius: 5px;">
                            <strong>Analogy:</strong> Think of ATP and NADPH as "charged batteries" produced in the light reactions and "used up" in the Calvin Cycle.
                        </p>
                    </div>
                    <div class="card" style="border-left: 4px solid #9b59b6;">
                        <h4>ADP, Pi, & NADP‚Å∫: Recycling</h4>
                        <p>The Calvin Cycle returns ADP, Pi (inorganic phosphate), and NADP‚Å∫ to the light reactions, where they are "recharged" back into ATP and NADPH. This creates a continuous cycle.</p>
                        <p style="margin-top: 10px; padding: 10px; background: #f3e5f5; border-radius: 5px;">
                            <strong>Key Insight:</strong> The cell doesn't need unlimited amounts of these molecules because they're recycled!
                        </p>
                    </div>
                </div>

                <h3>Factors Affecting Photosynthesis</h3>
                <p>The rate of photosynthesis can be limited by several environmental factors:</p>

                <div class="grid-2">
                    <div class="card">
                        <h4>üå°Ô∏è Temperature</h4>
                        <p><strong>Effect:</strong> Enzymes work best at optimal temperatures (typically 25-35¬∞C for most plants).</p>
                        <p><strong>Too low:</strong> Reactions slow down</p>
                        <p><strong>Too high:</strong> Enzymes denature</p>
                    </div>
                    <div class="card">
                        <h4>üí° Light Intensity</h4>
                        <p><strong>Effect:</strong> More light ‚Üí more energy for light reactions</p>
                        <p><strong>Limitation:</strong> At high intensity, light is no longer limiting; other factors become limiting (law of limiting factors)</p>
                    </div>
                    <div class="card">
                        <h4>üí® CO‚ÇÇ Concentration</h4>
                        <p><strong>Effect:</strong> More CO‚ÇÇ ‚Üí more substrate for Calvin Cycle</p>
                        <p><strong>Current levels:</strong> ~420 ppm in atmosphere, increasing due to human activities</p>
                    </div>
                    <div class="card">
                        <h4>üíß Water Availability</h4>
                        <p><strong>Effect:</strong> Water is a substrate in light reactions</p>
                        <p><strong>Limitation:</strong> Drought causes stomata to close, reducing CO‚ÇÇ uptake</p>
                    </div>
                </div>

                <div class="warning-box">
                    <h3>The Law of Limiting Factors</h3>
                    <p>The rate of photosynthesis is limited by the factor that is in shortest supply. For example, if a plant has plenty of light and water but insufficient CO‚ÇÇ, increasing the light won't increase the photosynthesis rate‚Äîyou need to add CO‚ÇÇ.</p>
                    <p style="margin-top: 10px;"><strong>Agricultural Application:</strong> Farmers and greenhouse operators manipulate these factors to maximize crop yields!</p>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Discussion Question:</strong> "How might climate change affect photosynthesis rates globally?" Consider temperature increases, CO‚ÇÇ levels, and precipitation changes.</p>
                    <p><strong>Lab Connection:</strong> This is an excellent point to reference any photosynthesis lab experiments students will perform.</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Photosynthesis & Respiration ‚Üí</button>
                </div>
            </section>

            <!-- Section 7: Relationship with Respiration -->
            <section class="section" id="section7" aria-labelledby="section7-title">
                <h2 id="section7-title">
                    <span aria-hidden="true">‚öñÔ∏è</span>
                    Photosynthesis and Cellular Respiration: Two Sides of the Same Coin
                </h2>

                <p>Photosynthesis and cellular respiration are complementary processes that together form the basis of energy flow in ecosystems. Understanding their relationship is essential for seeing the "big picture" of biology.</p>

                <div class="equation-box" role="img" aria-label="Comparison of photosynthesis and cellular respiration equations">
                    <div style="margin-bottom: 20px;">
                        <strong>Photosynthesis:</strong><br>
                        6CO‚ÇÇ + 6H‚ÇÇO + Light Energy ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ
                    </div>
                    <div style="font-size: 2em; margin: 20px 0;">‚áÖ</div>
                    <div>
                        <strong>Cellular Respiration:</strong><br>
                        C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ ‚Üí 6CO‚ÇÇ + 6H‚ÇÇO + ATP Energy
                    </div>
                </div>

                <div class="key-concept">
                    <h3>They Are Reverse Processes</h3>
                    <p>Notice that the products of photosynthesis (glucose and oxygen) are the reactants of cellular respiration, and vice versa. This creates a beautiful cycle of energy and matter.</p>
                </div>

                <h3>Comparing the Processes</h3>
                <div class="grid-2">
                    <div class="card" style="background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-left: 4px solid var(--success);">
                        <h4>Photosynthesis (Anabolic)</h4>
                        <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                            <li><strong>Energy:</strong> Absorbs light energy</li>
                            <li><strong>Location:</strong> Chloroplasts (plants only)</li>
                            <li><strong>Purpose:</strong> Build glucose from simple molecules</li>
                            <li><strong>Oxygen:</strong> Produced as byproduct</li>
                            <li><strong>Type:</strong> Endergonic (requires energy input)</li>
                        </ul>
                    </div>
                    <div class="card" style="background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border-left: 4px solid var(--error);">
                        <h4>Cellular Respiration (Catabolic)</h4>
                        <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                            <li><strong>Energy:</strong> Releases chemical energy</li>
                            <li><strong>Location:</strong> Mitochondria (all eukaryotes)</li>
                            <li><strong>Purpose:</strong> Break down glucose to release energy</li>
                            <li><strong>Oxygen:</strong> Used as final electron acceptor</li>
                            <li><strong>Type:</strong> Exergonic (releases energy)</li>
                        </ul>
                    </div>
                </div>

                <h3>The Global Cycle</h3>
                <div class="info-box">
                    <h4>The Carbon-Oxygen Cycle</h4>
                    <p>On a global scale, photosynthesis and cellular respiration maintain the balance of atmospheric gases:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li><strong>Photosynthesis</strong> removes CO‚ÇÇ from the atmosphere and adds O‚ÇÇ</li>
                        <li><strong>Cellular respiration</strong> removes O‚ÇÇ from the atmosphere and adds CO‚ÇÇ</li>
                        <li>These processes have maintained relatively stable atmospheric levels for millions of years</li>
                        <li>However, human activities (burning fossil fuels, deforestation) are disrupting this balance</li>
                    </ul>
                </div>

                <h3>Energy Flow in Ecosystems</h3>
                <div class="diagram-container">
                    <div style="text-align: center; padding: 20px;">
                        <div style="display: inline-block; background: #f1c40f; padding: 20px 40px; border-radius: 10px; margin: 10px;">
                            <strong>‚òÄÔ∏è SUNLIGHT</strong>
                        </div>
                        <div style="font-size: 2em; margin: 10px 0;">‚Üì</div>
                        <div style="display: inline-block; background: #2ecc71; color: white; padding: 20px 40px; border-radius: 10px; margin: 10px;">
                            <strong>üåø PRODUCERS</strong><br>
                            <span style="font-size: 0.8em;">(Plants/Photosynthesis)</span>
                        </div>
                        <div style="font-size: 2em; margin: 10px 0;">‚Üì</div>
                        <div style="display: inline-block; background: #e67e22; color: white; padding: 20px 40px; border-radius: 10px; margin: 10px;">
                            <strong>ü¶å CONSUMERS</strong><br>
                            <span style="font-size: 0.8em;">(Animals/Respiration)</span>
                        </div>
                        <div style="font-size: 2em; margin: 10px 0;">‚Üì</div>
                        <div style="display: inline-block; background: #95a5a6; color: white; padding: 20px 40px; border-radius: 10px; margin: 10px;">
                            <strong>üçÑ DECOMPOSERS</strong><br>
                            <span style="font-size: 0.8em;">(Bacteria/Fungi/Respiration)</span>
                        </div>
                    </div>
                </div>

                <div class="success-box">
                    <h3>Key Takeaway</h3>
                    <p><strong>Photosynthesis is the entry point for energy into ecosystems.</strong> All the energy in food chains originates from sunlight captured by photosynthetic organisms. Without photosynthesis, there would be no stored chemical energy for other organisms to use!</p>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Connection to Other Courses:</strong> This is an excellent tie-in to ecology, biogeochemical cycles, and environmental science.</p>
                    <p><strong>Critical Thinking:</strong> Ask students: "Plants perform both photosynthesis and cellular respiration. When does each occur, and what is the net result?"</p>
                    <p><strong>Answer:</strong> Photosynthesis occurs during day (when light available), respiration occurs 24/7. Net result: Plants produce more glucose than they consume, storing excess as starch.</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Real-World Applications ‚Üí</button>
                </div>
            </section>

            <!-- Section 8: Applications -->
            <section class="section" id="section8" aria-labelledby="section8-title">
                <h2 id="section8-title">
                    <span aria-hidden="true">üåç</span>
                    Real-World Applications and Current Research
                </h2>

                <p>Photosynthesis isn't just a textbook concept‚Äîit's at the heart of some of the most pressing challenges and exciting opportunities in science and technology today.</p>

                <h3>Agriculture and Food Security</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>Crop Improvement</h4>
                        <p>Scientists are working to engineer crops with more efficient photosynthesis to increase yields and feed growing populations.</p>
                        <p style="margin-top: 10px;"><strong>Example:</strong> Introducing C4 photosynthesis pathways into C3 crops like rice could increase productivity by 50%.</p>
                    </div>
                    <div class="card">
                        <h4>Greenhouse Management</h4>
                        <p>Commercial greenhouses optimize light, temperature, and CO‚ÇÇ levels to maximize photosynthesis rates.</p>
                        <p style="margin-top: 10px;"><strong>Practice:</strong> Many greenhouses now supplement CO‚ÇÇ to 1000-1500 ppm (vs. 420 ppm atmospheric).</p>
                    </div>
                </div>

                <h3>Climate Change and Carbon Sequestration</h3>
                <div class="info-box">
                    <h4>Photosynthesis as a Climate Solution</h4>
                    <p>Photosynthetic organisms remove approximately 123 gigatons of carbon from the atmosphere each year. Efforts to combat climate change include:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li><strong>Reforestation:</strong> Planting trees to increase global CO‚ÇÇ uptake</li>
                        <li><strong>Ocean fertilization:</strong> Stimulating phytoplankton growth (controversial)</li>
                        <li><strong>Artificial photosynthesis:</strong> Mimicking the process to create fuel from CO‚ÇÇ</li>
                    </ul>
                </div>

                <h3>Biofuels and Renewable Energy</h3>
                <div class="card">
                    <h4>Algal Biofuels</h4>
                    <p>Microalgae use photosynthesis to convert CO‚ÇÇ and sunlight into lipids that can be processed into biodiesel. Some advantages:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Much faster growth than terrestrial plants</li>
                        <li>Can be grown on non-arable land</li>
                        <li>Higher oil content than crop plants</li>
                        <li>Can use wastewater as nutrient source</li>
                    </ul>
                </div>

                <h3>Synthetic Biology and Artificial Photosynthesis</h3>
                <div class="grid-2">
                    <div class="card">
                        <h4>Artificial Leaves</h4>
                        <p>Researchers are developing devices that mimic photosynthesis to split water and produce hydrogen fuel using only sunlight.</p>
                        <p style="margin-top: 10px; padding: 10px; background: #e3f2fd; border-radius: 5px;">
                            <strong>Goal:</strong> Create a sustainable source of clean fuel directly from sunlight and water.
                        </p>
                    </div>
                    <div class="card">
                        <h4>Enhanced Photosynthesis</h4>
                        <p>Scientists are engineering plants and bacteria with improved photosynthetic efficiency by:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Optimizing light-harvesting pigments</li>
                            <li>Improving rubisco efficiency</li>
                            <li>Adding new metabolic pathways</li>
                        </ul>
                    </div>
                </div>

                <h3>Medical and Biotechnology Applications</h3>
                <div class="success-box">
                    <h4>Pharmaceuticals from Photosynthesis</h4>
                    <p>Many important medicines are derived from photosynthetic organisms:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li><strong>Aspirin:</strong> Originally from willow bark</li>
                        <li><strong>Taxol (cancer treatment):</strong> From Pacific yew trees</li>
                        <li><strong>Artemisinin (anti-malarial):</strong> From sweet wormwood plants</li>
                    </ul>
                    <p style="margin-top: 10px;">Researchers are now engineering photosynthetic organisms to produce these compounds more efficiently.</p>
                </div>

                <h3>Space Exploration</h3>
                <div class="warning-box">
                    <h4>Photosynthesis in Space</h4>
                    <p>NASA and other space agencies are developing photosynthetic systems for long-term space missions:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li><strong>Oxygen generation:</strong> Algae bioreactors produce O‚ÇÇ for astronauts</li>
                        <li><strong>Food production:</strong> Growing crops on Mars or the Moon</li>
                        <li><strong>CO‚ÇÇ recycling:</strong> Using astronaut-exhaled CO‚ÇÇ as raw material</li>
                    </ul>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Discussion Prompts:</strong></p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li>"What ethical considerations should guide photosynthesis research?"</li>
                        <li>"How might advances in photosynthesis affect developing nations?"</li>
                        <li>"What are the risks of engineering enhanced photosynthesis?"</li>
                    </ul>
                    <p style="margin-top: 10px;"><strong>Extension Activity:</strong> Have students research a current photosynthesis-related news article and present findings to the class.</p>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" onclick="nextSection()">Next: Final Assessment ‚Üí</button>
                </div>
            </section>

            <!-- Section 9: Final Assessment -->
            <section class="section" id="section9" aria-labelledby="section9-title">
                <h2 id="section9-title">
                    <span aria-hidden="true">üéØ</span>
                    Final Assessment
                </h2>

                <p>Test your comprehensive understanding of photosynthesis with this final assessment. Good luck!</p>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 1: Which statement best describes the relationship between the two stages of photosynthesis?
                    </div>
                    <div class="quiz-option" data-question="final1" data-correct="false" onclick="checkQuiz(this)">
                        A) They occur in completely separate locations at different times
                    </div>
                    <div class="quiz-option" data-question="final1" data-correct="true" onclick="checkQuiz(this)">
                        B) The products of light-dependent reactions are used as inputs for the Calvin Cycle
                    </div>
                    <div class="quiz-option" data-question="final1" data-correct="false" onclick="checkQuiz(this)">
                        C) They both require direct light energy to function
                    </div>
                    <div class="quiz-option" data-question="final1" data-correct="false" onclick="checkQuiz(this)">
                        D) The Calvin Cycle produces oxygen for the light reactions
                    </div>
                    <div class="feedback" id="feedbackfinal1"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 2: How many CO‚ÇÇ molecules must be fixed by the Calvin Cycle to produce one glucose molecule?
                    </div>
                    <div class="quiz-option" data-question="final2" data-correct="false" onclick="checkQuiz(this)">
                        A) 2
                    </div>
                    <div class="quiz-option" data-question="final2" data-correct="false" onclick="checkQuiz(this)">
                        B) 3
                    </div>
                    <div class="quiz-option" data-question="final2" data-correct="true" onclick="checkQuiz(this)">
                        C) 6
                    </div>
                    <div class="quiz-option" data-question="final2" data-correct="false" onclick="checkQuiz(this)">
                        D) 12
                    </div>
                    <div class="feedback" id="feedbackfinal2"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 3: What is the primary function of rubisco enzyme in photosynthesis?
                    </div>
                    <div class="quiz-option" data-question="final3" data-correct="false" onclick="checkQuiz(this)">
                        A) To split water molecules and release oxygen
                    </div>
                    <div class="quiz-option" data-question="final3" data-correct="true" onclick="checkQuiz(this)">
                        C) To attach CO‚ÇÇ to RuBP during carbon fixation
                    </div>
                    <div class="quiz-option" data-question="final3" data-correct="false" onclick="checkQuiz(this)">
                        B) To absorb light energy in the thylakoids
                    </div>
                    <div class="quiz-option" data-question="final3" data-correct="false" onclick="checkQuiz(this)">
                        D) To regenerate ATP and NADPH
                    </div>
                    <div class="feedback" id="feedbackfinal3"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 4: Why are photosynthesis and cellular respiration considered complementary processes?
                    </div>
                    <div class="quiz-option" data-question="final4" data-correct="false" onclick="checkQuiz(this)">
                        A) They both occur in chloroplasts
                    </div>
                    <div class="quiz-option" data-question="final4" data-correct="false" onclick="checkQuiz(this)">
                        B) They both produce glucose
                    </div>
                    <div class="quiz-option" data-question="final4" data-correct="true" onclick="checkQuiz(this)">
                        C) The products of one are the reactants of the other
                    </div>
                    <div class="quiz-option" data-question="final4" data-correct="false" onclick="checkQuiz(this)">
                        D) They both require light energy
                    </div>
                    <div class="feedback" id="feedbackfinal4"></div>
                </div>

                <div class="quiz-container">
                    <div class="quiz-question">
                        Question 5: Which factor would NOT directly limit the rate of photosynthesis?
                    </div>
                    <div class="quiz-option" data-question="final5" data-correct="false" onclick="checkQuiz(this)">
                        A) Light intensity
                    </div>
                    <div class="quiz-option" data-question="final5" data-correct="false" onclick="checkQuiz(this)">
                        B) CO‚ÇÇ concentration
                    </div>
                    <div class="quiz-option" data-question="final5" data-correct="true" onclick="checkQuiz(this)">
                        C) Soil nitrogen content (in short term)
                    </div>
                    <div class="quiz-option" data-question="final5" data-correct="false" onclick="checkQuiz(this)">
                        D) Temperature
                    </div>
                    <div class="feedback" id="feedbackfinal5"></div>
                </div>

                <div class="score-display" id="finalScore" style="display: none;">
                    <h3>Your Score</h3>
                    <div id="scoreValue" style="font-size: 3em; margin: 20px 0;">0/5</div>
                    <div id="scoreMessage"></div>
                </div>

                <div class="success-box" id="completionMessage" style="display: none;">
                    <h3>üéâ Congratulations!</h3>
                    <p>You've completed the interactive photosynthesis lesson. You should now have a solid understanding of:</p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li>The overall process and equation of photosynthesis</li>
                        <li>Chloroplast structure and its role</li>
                        <li>Light-dependent reactions in thylakoids</li>
                        <li>Light-independent reactions (Calvin Cycle) in stroma</li>
                        <li>The relationship between photosynthesis and cellular respiration</li>
                        <li>Real-world applications and current research</li>
                    </ul>
                    <p style="margin-top: 15px; font-weight: bold;">Keep exploring the fascinating world of plant biology!</p>
                </div>

                <div class="instructor-notes">
                    <h4>üìù Instructor Notes</h4>
                    <p><strong>Assessment Strategy:</strong> This final quiz tests both factual knowledge and conceptual understanding across all lesson sections.</p>
                    <p><strong>Follow-up Activities:</strong></p>
                    <ul style="margin-left: 30px; margin-top: 10px; line-height: 1.8;">
                        <li>Lab: Measure photosynthesis rate using floating leaf disks</li>
                        <li>Discussion: Debate the ethics of genetically modified crops with enhanced photosynthesis</li>
                        <li>Project: Research a photosynthesis-related current event</li>
                        <li>Extension: Explore C4 and CAM photosynthesis adaptations</li>
                    </ul>
                </div>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="previousSection()">‚Üê Previous</button>
                    <button class="btn" id="finalSubmit" onclick="submitFinalAssessment()">Submit Assessment</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Global variables
        let currentSection = 1;
        const totalSections = 9;
        let quizScores = {
            section4: { answered: 0, correct: 0 },
            final: { answered: 0, correct: 0 }
        };
        let ttsEnabled = false;
        let timerRunning = false;
        let timerSeconds = 0;
        let timerInterval;
        let calvinPhaseCorrect = 0;

        // Accessibility functions
        function adjustTextSize(size) {
            document.body.classList.remove('text-small', 'text-large');
            if (size === 'small') {
                document.body.classList.add('text-small');
            } else if (size === 'large') {
                document.body.classList.add('text-large');
            }
            speak(`Text size set to ${size}`);
        }

        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            const isEnabled = document.body.classList.contains('high-contrast');
            speak(isEnabled ? 'High contrast mode enabled' : 'High contrast mode disabled');
        }

        function toggleTTS() {
            ttsEnabled = !ttsEnabled;
            const btn = document.getElementById('ttsToggle');
            btn.textContent = ttsEnabled ? 'üîä Text-to-Speech: ON' : 'üîä Text-to-Speech: OFF';
            speak(ttsEnabled ? 'Text to speech enabled' : 'Text to speech disabled');
        }

        function speak(text) {
            if (ttsEnabled && 'speechSynthesis' in window) {
                // Cancel any ongoing speech
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            }
        }

        function readSection() {
            if (!ttsEnabled) return;
            
            const activeSection = document.querySelector('.section.active');
            if (activeSection) {
                const title = activeSection.querySelector('h2').textContent;
                const content = activeSection.textContent;
                speak(title);
            }
        }

        // Timer functions
        function toggleTimer() {
            timerRunning = !timerRunning;
            const btn = document.getElementById('timerToggle');
            
            if (timerRunning) {
                btn.textContent = 'Pause Timer';
                timerInterval = setInterval(updateTimer, 1000);
            } else {
                btn.textContent = 'Resume Timer';
                clearInterval(timerInterval);
            }
        }

        function updateTimer() {
            timerSeconds++;
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timer').textContent = 
                `Time: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // Navigation functions
        function updateProgress() {
            const progress = ((currentSection - 1) / (totalSections - 1)) * 100;
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = progress + '%';
            progressFill.textContent = Math.round(progress) + '%';
            
            document.getElementById('sectionCounter').textContent = `Section ${currentSection} of ${totalSections}`;
            
            let status = '';
            if (progress < 25) status = 'Just getting started!';
            else if (progress < 50) status = 'Making good progress!';
            else if (progress < 75) status = 'Over halfway there!';
            else if (progress < 100) status = 'Almost finished!';
            else status = 'Complete! üéâ';
            
            document.getElementById('completionStatus').textContent = status;
        }

        function nextSection() {
            if (currentSection < totalSections) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection++;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
                readSection();
            }
        }

        function previousSection() {
            if (currentSection > 1) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection--;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
                readSection();
            }
        }

        // Chloroplast diagram interaction
        function showChloroplastInfo(part) {
            const infoBox = document.getElementById('chloroplastInfo');
            const titleEl = document.getElementById('chloroplastInfoTitle');
            const textEl = document.getElementById('chloroplastInfoText');
            
            const info = {
                outer: {
                    title: '1. Outer Membrane',
                    text: 'The outer membrane is a smooth, permeable boundary that allows small molecules to pass through freely. It separates the chloroplast from the cytoplasm of the cell.'
                },
                inner: {
                    title: '2. Inner Membrane',
                    text: 'The inner membrane is more selective, controlling the transport of molecules into and out of the chloroplast. It contains specific transport proteins for various substances.'
                },
                stroma: {
                    title: '3. Stroma',
                    text: 'The stroma is a fluid-filled space containing enzymes, DNA, ribosomes, and other molecules necessary for the Calvin Cycle. This is where carbon fixation occurs and glucose is assembled.'
                },
                thylakoid: {
                    title: '4. Thylakoid',
                    text: 'Thylakoids are flattened, membrane-bound sacs where the light-dependent reactions occur. The thylakoid membrane contains chlorophyll and other pigments that capture light energy, as well as the proteins of the electron transport chain.'
                },
                granum: {
                    title: '5. Granum (Stack of Thylakoids)',
                    text: 'A granum is a stack of thylakoids. Stacking increases the surface area available for light absorption and allows for efficient energy transfer between photosystems. Chloroplasts typically contain 40-60 grana.'
                }
            };
            
            if (info[part]) {
                titleEl.textContent = info[part].title;
                textEl.textContent = info[part].text;
                
                // Add a highlight animation
                infoBox.style.animation = 'none';
                setTimeout(() => {
                    infoBox.style.animation = 'highlightPulse 0.5s ease';
                }, 10);
                
                // Scroll info box into view smoothly
                infoBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                
                speak(info[part].title + '. ' + info[part].text);
            }
        }

        // Light reaction animation
        let animationStep = 0;
        let animationInterval;

        function startLightReactionAnimation() {
            const btn = document.getElementById('animationBtn');
            const stage = document.getElementById('lightReactionStage');
            const text = document.getElementById('animationText');
            
            if (btn.textContent === 'Start Animation') {
                btn.textContent = 'Reset Animation';
                animationStep = 0;
                runLightAnimation();
            } else {
                btn.textContent = 'Start Animation';
                clearInterval(animationInterval);
                stage.innerHTML = '<div style="text-align: center; color: white; font-size: 1.2em; padding: 20px;" id="animationText">Click "Start Animation" to begin</div>';
            }
        }

        function runLightAnimation() {
            const stage = document.getElementById('lightReactionStage');
            const steps = [
                {
                    text: 'Step 1: Photon of light strikes Photosystem II',
                    html: '<div class="photon" style="top: 20px; left: 50%; animation: glow 1s infinite;"></div><div style="text-align: center; color: white; padding-top: 80px;">‚òÄÔ∏è Light Energy Absorbed</div>'
                },
                {
                    text: 'Step 2: Water molecule is split, releasing O‚ÇÇ',
                    html: '<div style="text-align: center; color: white;"><div style="font-size: 2em;">H‚ÇÇO ‚Üí 2H‚Å∫ + ¬ΩO‚ÇÇ + 2e‚Åª</div><div style="margin-top: 20px; font-size: 1.5em;">üíß ‚Üí üí® O‚ÇÇ</div></div>'
                },
                {
                    text: 'Step 3: Electrons move through electron transport chain',
                    html: '<div class="electron" style="top: 50%; left: 10%; animation: slideRight 2s infinite;"></div><div style="text-align: center; color: white; padding-top: 100px;">‚ö° Electron Transport Chain</div>'
                },
                {
                    text: 'Step 4: H‚Å∫ ions are pumped into thylakoid space',
                    html: '<div style="text-align: center; color: white;"><div style="font-size: 2em;">H‚Å∫ H‚Å∫ H‚Å∫</div><div style="margin-top: 20px;">Building concentration gradient</div></div>'
                },
                {
                    text: 'Step 5: Photosystem I captures more light energy',
                    html: '<div class="photon" style="top: 20px; left: 50%; animation: glow 1s infinite;"></div><div style="text-align: center; color: white; padding-top: 80px;">‚òÄÔ∏è More Light Absorbed at PSI</div>'
                },
                {
                    text: 'Step 6: NADP‚Å∫ is reduced to NADPH',
                    html: '<div style="text-align: center; color: white;"><div style="font-size: 2em;">NADP‚Å∫ + 2e‚Åª + H‚Å∫ ‚Üí NADPH</div><div style="margin-top: 20px;">üîã Energy carrier created!</div></div>'
                },
                {
                    text: 'Step 7: ATP synthase produces ATP from flowing H‚Å∫ ions',
                    html: '<div style="text-align: center; color: white;"><div style="font-size: 2em;">ADP + Pi ‚Üí ATP</div><div style="margin-top: 20px;">‚ö° Energy stored in ATP!</div></div>'
                },
                {
                    text: 'Complete! Products: ATP, NADPH, and O‚ÇÇ',
                    html: '<div style="text-align: center; color: white;"><div style="font-size: 1.5em; margin-bottom: 20px;">‚úÖ Light Reactions Complete!</div><div style="font-size: 1.2em;">Products:<br>ATP (energy) + NADPH (reducing power) + O‚ÇÇ</div></div>'
                }
            ];
            
            if (animationStep < steps.length) {
                const step = steps[animationStep];
                stage.innerHTML = step.html;
                speak(step.text);
                animationStep++;
                setTimeout(runLightAnimation, 3000);
            } else {
                document.getElementById('animationBtn').textContent = 'Start Animation';
                animationStep = 0;
            }
        }

        // Drag and drop for Calvin Cycle
        function initDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
        }

        function handleDragStart(e) {
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
            e.dataTransfer.setData('phase', this.dataset.phase);
            this.classList.add('dragging');
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            this.classList.add('drag-over');
            return false;
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            this.classList.remove('drag-over');
            
            const phase = e.dataTransfer.getData('phase');
            const expectedPhase = this.dataset.position;
            
            if (phase === expectedPhase) {
                this.innerHTML = e.dataTransfer.getData('text/html');
                this.classList.add('correct');
                calvinPhaseCorrect++;
                
                if (calvinPhaseCorrect === 3) {
                    const feedback = document.getElementById('calvinFeedback');
                    feedback.className = 'feedback success show';
                    feedback.textContent = '‚úì Perfect! You correctly ordered all three phases of the Calvin Cycle!';
                    speak('Perfect! You correctly ordered all three phases of the Calvin Cycle!');
                }
            } else {
                this.classList.add('incorrect');
                const feedback = document.getElementById('calvinFeedback');
                feedback.className = 'feedback error show';
                feedback.textContent = '‚úó Not quite right. Try again! Hint: Think about the order‚Äîfixing carbon first, then reducing it, then regenerating the acceptor.';
                speak('Not quite right. Try again.');
                setTimeout(() => {
                    this.classList.remove('incorrect');
                    feedback.classList.remove('show');
                }, 2000);
            }
            
            return false;
        }

        // Quiz functions
        function checkQuiz(element) {
            const questionId = element.dataset.question;
            const isCorrect = element.dataset.correct === 'true';
            const feedback = document.getElementById('feedback' + questionId);
            
            // Remove previous selections
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selection
            element.classList.add('selected');
            
            if (isCorrect) {
                element.classList.add('correct');
                feedback.className = 'feedback success show';
                feedback.textContent = '‚úì Correct! Well done!';
                speak('Correct! Well done!');
                
                // Update quiz scores
                if (questionId.startsWith('final')) {
                    if (!quizScores.final[questionId]) {
                        quizScores.final.answered++;
                        quizScores.final.correct++;
                        quizScores.final[questionId] = true;
                    }
                } else {
                    if (!quizScores.section4[questionId]) {
                        quizScores.section4.answered++;
                        quizScores.section4.correct++;
                        quizScores.section4[questionId] = true;
                    }
                }
                
                // Check if quiz section is complete
                if (currentSection === 4 && quizScores.section4.answered === 3) {
                    document.getElementById('quiz1Complete').style.display = 'block';
                    document.getElementById('quiz1Next').disabled = false;
                }
            } else {
                element.classList.add('incorrect');
                feedback.className = 'feedback error show';
                
                // Provide specific feedback
                const correctAnswer = Array.from(options).find(opt => opt.dataset.correct === 'true');
                feedback.textContent = `‚úó Not quite. The correct answer is: ${correctAnswer.textContent}`;
                speak('Not quite. Try again.');
                
                if (questionId.startsWith('final')) {
                    if (!quizScores.final[questionId]) {
                        quizScores.final.answered++;
                        quizScores.final[questionId] = false;
                    }
                } else {
                    if (!quizScores.section4[questionId]) {
                        quizScores.section4.answered++;
                        quizScores.section4[questionId] = false;
                    }
                }
            }
        }

        function submitFinalAssessment() {
            const totalQuestions = 5;
            const score = quizScores.final.correct;
            const scoreDisplay = document.getElementById('finalScore');
            const scoreValue = document.getElementById('scoreValue');
            const scoreMessage = document.getElementById('scoreMessage');
            const completionMessage = document.getElementById('completionMessage');
            
            scoreValue.textContent = `${score}/${totalQuestions}`;
            
            let message = '';
            if (score === 5) {
                message = 'Outstanding! You have mastered the concepts of photosynthesis! üåü';
            } else if (score >= 4) {
                message = 'Excellent work! You have a strong understanding of photosynthesis. üëè';
            } else if (score >= 3) {
                message = 'Good job! You understand the basics. Review the material for even better mastery. üìö';
            } else {
                message = 'Keep studying! Review the lesson and try again. You can do it! üí™';
            }
            
            scoreMessage.textContent = message;
            scoreDisplay.style.display = 'block';
            completionMessage.style.display = 'block';
            
            speak(`You scored ${score} out of ${totalQuestions}. ${message}`);
            
            // Update progress to 100%
            updateProgress();
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            // Left arrow for previous
            if (e.key === 'ArrowLeft' && currentSection > 1) {
                previousSection();
            }
            // Right arrow for next
            if (e.key === 'ArrowRight' && currentSection < totalSections) {
                nextSection();
            }
            // R for read section
            if (e.key === 'r' || e.key === 'R') {
                readSection();
            }
        });

        // Add keyboard support for hotspots
        document.querySelectorAll('.hotspot').forEach(hotspot => {
            hotspot.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        });

        // Initialize on load
        window.addEventListener('load', function() {
            updateProgress();
            initDragAndDrop();
            
            // Add CSS animation for glowing effect
            const style = document.createElement('style');
            style.textContent = `
                @keyframes glow {
                    0%, 100% { box-shadow: 0 0 20px #f1c40f; }
                    50% { box-shadow: 0 0 40px #f39c12; }
                }
                @keyframes slideRight {
                    0% { left: 10%; }
                    100% { left: 90%; }
                }
            `;
            document.head.appendChild(style);
            
            speak('Welcome to the interactive photosynthesis lesson. Use the arrow keys to navigate, or press R to have content read aloud.');
        });
    </script>
</body>
</html>